<?xml version="1.0" encoding="UTF-8" ?>
<configuration>
    <appender name="console" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d [%thread] %level %logger{35} %msg%n</pattern>
        </encoder>
    </appender>

    <property name="LOG_DIR" value="src/test/resources/logs"/>
    <!--TEST 1-->
    <appender name="appender-test-1" class="ch.qos.logback.core.FileAppender">
        <file>${LOG_DIR}/file-test-1.log</file>
        <append>false</append>
        <encoder>
            <pattern>%d %m%n</pattern>
        </encoder>
    </appender>

    <logger name="logger-test-1">
        <appender-ref ref="appender-test-1"/>
    </logger>
    <!--TEST 2-->
    <appender name="appender-test-2" class="ch.qos.logback.core.FileAppender">
        <file>${LOG_DIR}/file-test-2.log</file>
        <append>false</append>
        <encoder>
            <pattern>%d %level %m%n</pattern>
        </encoder>
    </appender>

    <logger name="logger-test-2">
        <appender-ref ref="appender-test-2"/>
    </logger>
    <!--TEST 3-->
    <appender name="appender-test-3" class="ch.qos.logback.core.FileAppender">
        <file>${LOG_DIR}/file-test-3.log</file>
        <append>false</append>
        <encoder>
            <pattern>%d %logger %m%n</pattern>
        </encoder>
    </appender>

    <logger name="logger-test-3-a">
        <appender-ref ref="appender-test-3"/>
    </logger>

    <logger name="logger-test-3-b">
        <appender-ref ref="appender-test-3"/>
    </logger>

    <!--TEST 4-->
    <appender name="appender-test-4" class="ch.qos.logback.core.FileAppender">
        <file>${LOG_DIR}/file-test-4.log</file>
        <append>false</append>
        <encoder>
            <pattern>%d %thread %m%n</pattern>
        </encoder>
    </appender>

    <logger name="logger-test-4">
        <appender-ref ref="appender-test-4"/>
    </logger>

    <!--KIBANA-->
    <appender name="ELASTIC" class="com.internetitem.logback.elasticsearch.ElasticsearchAppender">
        <url>http://localhost:9200/_bulk</url>
        <index>logs-%date{yyyy-MM-dd}</index>
        <type>tester</type>
        <loggerName>es-logger</loggerName> <!-- optional -->
        <errorLoggerName>es-error-logger</errorLoggerName> <!-- optional -->
        <connectTimeout>30000</connectTimeout> <!-- optional (in ms, default 30000) -->
        <errorsToStderr>false</errorsToStderr> <!-- optional (default false) -->
        <includeCallerData>false</includeCallerData> <!-- optional (default false) -->
        <logsToStderr>false</logsToStderr> <!-- optional (default false) -->
        <maxQueueSize>104857600</maxQueueSize> <!-- optional (default 104857600) -->
        <maxRetries>3</maxRetries> <!-- optional (default 3) -->
        <readTimeout>30000</readTimeout> <!-- optional (in ms, default 30000) -->
        <sleepTime>250</sleepTime> <!-- optional (in ms, default 250) -->
        <rawJsonMessage>false</rawJsonMessage> <!-- optional (default false) -->
        <includeMdc>false</includeMdc> <!-- optional (default false) -->
        <maxMessageSize>100</maxMessageSize> <!-- optional (default -1 --><!-- optional -->
        <properties>
            <property name="host" value="localhost"/>
            <property name="severity" value="%level"/>
            <property name="thread" value="%thread"/>
            <property name="stacktrace" value="%ex"/>
            <property name="logger" value="%logger"/>
        </properties>
        <headers>
            <header>
                <name>Content-Type</name>
                <value>application/json</value>
            </header>
        </headers>
    </appender>

    <root level="debug">
        <appender-ref ref="console"/>
        <appender-ref ref="ELASTIC"/>
    </root>

    <logger name="es-error-logger" level="INFO" additivity="false">
        <appender-ref ref="FILELOGGER"/>
    </logger>

    <logger name="es-logger" level="INFO" additivity="false">
        <appender name="ES_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
            <!-- ... -->
            <encoder>
                <pattern>%msg
                </pattern> <!-- This pattern is important, otherwise it won't be the raw Elasticsearch format anyomre -->
            </encoder>
        </appender>
    </logger>
    <!--    <pattern>[%thread] %level %mdc %logger{35} -%kvp -%msg%n</pattern>-->

</configuration>